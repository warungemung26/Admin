<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title></title>
<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/sidebar.css">
<link rel="stylesheet" href="css/bottom-nav.css">
<link rel="stylesheet" href="css/flash.css">
<link rel="stylesheet" href="css/tabs.css">
<link rel="stylesheet" href="css/tabel-produk.css">
<link rel="stylesheet" href="css/produk-input.css">



</head>
<body>

<div class="admin-topbar">	

  <div class="top-left">
    <div class="admin-logo-text">EMU</div>
  </div>

  <div class="top-center">
    <div class="search-wrap top-search">
      <input id="searchInput" placeholder="Cari produk..." autocomplete="off">
      <span id="searchClear" class="search-clear">âŒ</span>
      <div id="searchSuggest" class="search-suggest"></div>
    </div>
  </div>

  <div class="top-right">
    <button class="dot-btn" onclick="toggleTopMenu()">â‹®</button>

    <div id="topMenu" class="top-menu hidden">
      <div onclick="switchTab('offline')">ğŸ“¦ Produk</div>
      <div onclick="switchTab('flash')">âš¡ Promo</div>
      <div onclick="switchTab('repo')">ğŸ–¼ Media</div>
      <div onclick="switchTab('token')">âš™ Pengaturan</div>
    </div>
  </div>

</div>


<!-- ============================================================
     TAB â€” PRODUK
============================================================ -->
<div id="tab-offline" class="tab-content active">
	
<div class="workflow-wrap">

  <div class="workflow-bar">
    <span data-step="import">ğŸ“¥ Import</span>
    <span data-step="generate">ğŸ§¬ Generate</span>
    <span data-step="publish">ğŸš€ Publish</span>
    <span data-step="backup">ğŸ“¥ Backup</span>
  </div>

  <div id="produkFlowStatus" class="source-status">
    ğŸ“Œ Silakan import produk dari GitHub.
  </div>

</div>
	

<h3 class="section-title">â• Input Produk</h3>
<!-- MINI IMPORT JSON -->
<div class="card json-mini">
  <details>
    <summary>ğŸ“¥ Import Banyak Produk (JSON)</summary>
    <textarea id="jsonInput" placeholder='Tempelkan array JSON di sini...'></textarea>
    <div class="json-actions">
      <button onclick="importJSON()">ğŸ“¤ Import</button>
      <button onclick="clearJSONInput()">ğŸ§¹ Bersihkan</button>
    </div>
  </details>
</div>
<!-- FORM TAMBAH -->
<div class="card">
  <h3>ğŸ›ï¸ Tambah Produk Baru</h3>
  <div class="admin-form">
    <input type="text" id="name" placeholder="Nama Produk">
    <input type="number" id="price" placeholder="Harga (Rp)">

    <label>Kategori:</label>
    <select id="categorySelect" onchange="toggleCustomCategory(this)">
      <option value="">Pilih Kategori</option>
      <option value="sembako">Sembako</option>
      <option value="makanan">Makanan Cepat Saji</option>
      <option value="mie">Mie Instan</option>
      <option value="snack">Snack</option>
      <option value="minuman">Minuman</option>
      <option value="minumansachet">Obat</option>
      <option value="rumah">Rumah</option>
      <option value="custom">Custom...</option>
    </select>

    <input type="text" id="customCategory" placeholder="Tulis kategori baru..." style="display:none;">

    <label>Gambar Produk:</label>
    <div style="display:flex; gap:10px;">
      <input type="text" id="imageName" placeholder="nama-file-gambar">
      <button type="button" onclick="triggerFilePickerTemp()">ğŸ“ Pilih</button>
    </div>

    <button class="btn-add" onclick="addProduct()">+ Tambah Produk</button>
  </div>
</div>




<!-- PRODUK TABLE PAKET -->
<div class="card table-pack">

  <div class="table-head">
    <h3>ğŸ“‹ Data Produk</h3>

    <div class="table-tools">
      <select id="filterCategory" onchange="applyFilter()">
        <option value="">Semua Kategori</option>
      </select>

      <select id="sortOption" onchange="applyFilter()">
        <option value="">Urutkan</option>
        <option value="nameAsc">Aâ€“Z</option>
        <option value="nameDesc">Zâ€“A</option>
        <option value="priceLow">Termurah</option>
        <option value="priceHigh">Termahal</option>
      </select>

      
      <button onclick="resetFilter()">ğŸ”„</button>
      <button onclick="openConfirmDeleteAll()" class="danger">ğŸ—‘</button>
    </div>
  </div>

  <div class="table-wrap">
    <table id="productTable">
      <thead>
        <tr>
          <th>No</th>
          <th>Nama</th>
          <th>Harga</th>
          <th>Kategori</th>
          <th>Gambar</th>
          <th>Aksi</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

</div>



<!-- OUTPUT -->
<div class="card">
  <h3>ğŸ“¦ Output JSON</h3>
  <button onclick="generateAndScrollJSON()">ğŸ”„ Generate</button>
  <pre id="jsonOutput">[ Kosong ]</pre>
    <button onclick="copyJSON()">ğŸ“‹ Copy</button>
  <button onclick="window.open('tools/ai-product-generator.html','_blank')">ğŸ¤– AI Generator</button>
</div>

</div>

</body>

<!-- ============================================================
     TAB FLASH SALE
============================================================ -->
<div id="tab-flash" class="tab-content">
	<div class="workflow-wrap">

  <div class="workflow-bar flash-flow">
    <span data-step="import">ğŸ“¥ Import</span>
    <span data-step="generate">ğŸ§¬ Generate</span>
    <span data-step="publish">ğŸš€ Publish</span>
    <span data-step="backup">ğŸ“¥ Backup</span>
  </div>

  <div id="flashFlowStatus" class="source-status">
    ğŸ“Œ Silakan import data flash terlebih dahulu.
  </div>

</div>

  <h2>âš¡ Kelola Flash Sale</h2>

  <!-- IMPORT BOX -->
  <div class="flash-import-box">
    <h3>ğŸ“¥ Import JSON Flash</h3>

    <!-- Import via FILE -->
    <input type="file" id="flashFileInput" accept="application/json">
    <button onclick="importFlashFromFile()">ğŸ“ Import dari File</button>

    <!-- Import via TEXT -->
    <textarea id="flashJsonText" placeholder="Paste JSON flash sale di sini..."></textarea>
    <button onclick="importFlashFromText()">ğŸ“¥ Import dari Kode</button>
    <button onclick="clearFlashJson()">ğŸ§¹ Bersihkan Kode</button>
  </div>

  <!-- INPUT FLASH -->
  <div class="card">
    <h3>âš¡ Flash Sale</h3>
    <div class="admin-form">
      <input type="text" id="flash_name" placeholder="Nama Produk">
      <input type="number" id="flash_price_normal" placeholder="Harga Normal">
      <input type="number" id="flash_price_flash" placeholder="Harga Flash">
      <input type="number" id="flash_stock" placeholder="Stok">
      <input type="text" id="flash_img" placeholder="URL Gambar">
      <input type="text" id="flash_label" placeholder="Deskripsi">
      <input type="datetime-local" id="flash_until">
      <button onclick="addFlashProduct()">â• Tambah Flash Sale</button>
    </div>
  </div>


<!-- BAR ATAS FLASH TABLE -->
<div style="display:flex; gap:10px; margin-bottom:10px;">
  <button id="btnLoadFlashTop" class="btn">
    ğŸ”„ Sync Flash Sale dari Repo
  </button>
</div>

<div class="table-wrap">
  <table id="flashTable">
    <thead>
      <tr>
        <th>No</th>
        <th>Nama</th>
        <th>Harga Normal</th>
        <th>Harga Flash</th>
        <th>Stok</th>
        <th>Gambar</th>
        <th>Label</th>
        <th>Flash Sampai</th>
        <th>Aksi</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<!-- ============================================================
     OUTPUT JSON FLASH
============================================================ -->
<div class="card" id="flash_json_section">
  <h3>ğŸ“¤ JSON Flash</h3>

  <button onclick="generateAndScrollFlashJSON()">ğŸ’¾ Generate JSON Flash</button>
  <button onclick="copyFlashJSON()">ğŸ“‹ Copy</button>

  <pre id="flashJsonOutput">[ Kosong ]</pre>
</div>

  <!-- EXPORT -->
  <div style="margin-top:10px;">
    <button onclick="downloadFlashJSON()">ğŸ“¤ Download JSON Flash</button>
  </div>
</div>

<!-- ============================================================
     TAB 2 â€” REPO MANAGER
============================================================ -->
<div id="tab-repo" class="tab-content">

  <h2>ğŸŒ Kelola Repo GitHub</h2>

  <div class="card">
    <h3>ğŸ“‚ Upload Gambar Massal</h3>
    <input type="file" id="filePicker" multiple accept="image/*">
    <button id="uploadMassalBtn">ğŸš€ Upload</button>
    <div id="previewArea"></div>
  </div>

  <div class="card">
    <h3>ğŸ—‚ï¸ Kelola Folder Repo</h3>
    <input id="folderPath" placeholder="nama-folder (misal: images)">
    <button id="loadFolder">ğŸ“‚ Load</button>
    <button id="deleteSelected">ğŸ—‘ï¸ Hapus Terpilih</button>
    <button id="deleteAll">ğŸ—‘ï¸ Hapus Semua</button>
    <button onclick="buatFolderBaru()">ğŸ“ Buat Folder Baru</button>

    <div id="fileList">
      <small>Menunggu load folder...</small>
    </div>
  </div>


<!-- =========================
     REPO MANAGER (UPLOAD)
========================= -->
  <div class="card" id="repoManager">
    <h3>ğŸ” Repo Produk Manager</h3>
  <!-- ====== PUSH ZIP TO GITHUB ====== -->
<div class="push-zip-box">

  <!-- Token (jika sudah ada di localStorage, bisa kamu sembunyikan) -->
  <label class="label">GitHub Token</label>
  <input type="text" id="githubToken" placeholder="Masukkan token GitHub" />

  <!-- Picker ZIP -->
  <label class="label">Pilih File ZIP</label>
  <input type="file" id="zipInputSafe" accept=".zip" />

  <!-- Tombol Upload -->
  <button id="btnPushZip" onclick="pushZipToGitHubSafe()">
    ğŸš€ Push ZIP ke GitHub
  </button>

  <!-- Progress Bar -->
  <progress id="pushProgress" max="100" value="0"></progress>

  <!-- Status Log -->
  <div id="pushStatus"></div>

</div>
     <button id="btnUploadProduk">ğŸ“¤ Upload Produk JSON</button>
    <button id="btnUploadFlash">ğŸ“¤ Upload Flash JSON</button>
    <button id="btnLoadFlash">ğŸ” Load Flash dari Repo</button>
     <button onclick="downloadFlashJSON()">â¬‡ Download JSON Flash</button>
    <button onclick="downloadJSON()">â¬‡ï¸ Download JSON</button>
    <button onclick="exportToExcel()">â¬‡ï¸ Export Excel</button>
   </div>
  <p style="font-size:12px;color:#666;margin-top:8px;">
    Pastikan token memiliki repo scope. File akan diupload ke <code>data/produk.json</code> dan <code>data/flash.json</code>.
  </p>
  <div class="card">
  <h3>ğŸ§° Tools Tambahan</h3>

<button onclick="window.open('tools/github-push-zip.html','_blank')">
  ğŸ“¦ Push ZIP Custom Repo ke GitHub
</button>

<button onclick="window.open('tools/wa-admin.html','_blank')">
  ğŸ’» Admin Whatsapp
</button>

<button onclick="openTagEditor()">
  ğŸ·ï¸ Edit Tag Produk
</button>

<script>
function openTagEditor(){
  window.open('tools/tagEditorUpdate.html', '_blank');
}
</script>

</div>
</div>

</div>




<!-- ============================================================
     TAB 3 â€” TOKEN
============================================================ -->
<div id="tab-token" class="tab-content">

  <h2>ğŸ” GitHub Token Manager</h2>

  <div class="card">
    <label>Token GitHub:</label>
    <input id="githubToken" type="password" placeholder="Masukkan token">

    <button id="btnPaste">ğŸ“‹ Paste</button>
    <button id="btnUseStored">ğŸ”‘ Pakai Token Tersimpan</button>
    <button id="btnSave">ğŸ’¾ Simpan (Encrypted)</button>
    <button id="btnSavePlain">ğŸ’¾ Simpan (Plain)</button>
    <button id="btnClearStored" style="color:red;">ğŸ—‘ Hapus Token</button>

    <input id="passphrase" type="password" placeholder="Passphrase optional">
  </div>

</div>

<!-- ============= MODAL KONFIRMASI ============= -->
<div id="confirmModal">
  <div id="confirmBox">
  	
    <h3>âš  Hapus Semua Produk?</h3>
    <p>Semua data produk offline akan dihapus permanen.</p>

    <button style="background:#ff3b30; color:white;" onclick="deleteAllProducts()">Ya, hapus semua</button>
    <button onclick="closeConfirmDeleteAll()">Batal</button>
  </div>
</div>

<!-- Modal Konfirmasi Hapus Semua -->
<div id="modalConfirm" class="modal" style="display:none;">
  <div class="modal-content">
    <p id="modalMessage">Apakah yakin ingin menghapus semua item?</p>
    <div class="modal-actions">
      <button id="modalCancel">Batal</button>
      <button id="modalConfirmBtn">Hapus</button>
    </div>
  </div>
</div>


<!-- TOAST -->
<div id="toast" class="toast"></div>

<!-- ================== JAVASCRIPT ================== -->

<!-- CORE & GLOBAL -->
<script src="js/helpers.js"></script>
<script src="js/init-data.js"></script>

<!-- STATE / FLOW -->
<script src="js/produk-workflow.js"></script>

<!-- UI LAYER -->
<script src="js/ui-modal.js"></script>
<script src="js/ui-tabs.js"></script>
<script src="js/import-lokal-json.js"></script>
<script src="js/generate-json.js"></script>
<script src="js/rename-image-picker.js"></script>
<script src="js/bottom-nav.js"></script>

<!-- TOKEN & AUTH -->
<script src="js/token-manager.js"></script>

<!-- REPO / GITHUB -->
<script src="js/repo-import.js"></script>
<script src="js/repo-folder-manager.js"></script>
<script src="js/upload-images.js"></script>
<script src="js/push-zip.js"></script>

<!-- PRODUK & FLASH -->
<script src="js/flash.js"></script>
<script src="js/flash-json.js"></script>

<!-- UI TABLE LAST -->
<script src="js/ui-table.js"></script>

<!-- MAIN BOOTSTRAP -->
<script src="js/main.js"></script>



<!-- ================== NAVIGASI================== -->
<!-- Bottom nav default (produk biasa) -->
<div id="bottom-nav-normal" class="bottom-nav">

  <button class="nav-btn github" onclick="loadProdukFromRepo()">
    ğŸ“¥ Import
  </button>

  <button class="nav-btn" onclick="generateAndScrollJSON()">
    ğŸ§¬ Generate
  </button>

  <button class="nav-btn" id="btnUploadProdukNav">
  ğŸš€ Upload
</button>

  <button class="nav-btn" onclick="downloadJSON()">
    ğŸ“¦ Backup
  </button>

</div>


<div id="bottom-nav-flash" class="bottom-nav" style="display:none;">

  <button class="nav-btn" id="navFlashImport"
          onclick="document.getElementById('btnLoadFlash')?.click()">
    ğŸ“¥ Import
  </button>

  <button class="nav-btn" id="navFlashGenerate"
          onclick="generateAndScrollFlashJSON()">
    ğŸ§¬ Generate
  </button>

  <button class="nav-btn" id="navFlashUpload"
          onclick="document.getElementById('btnUploadFlash')?.click()">
    ğŸš€ Upload
  </button>

  <button class="nav-btn" id="navFlashBackup"
          onclick="downloadFlashJSON()">
    ğŸ“¦ Backup
  </button>

</div>


</div>


</body>
</html>
